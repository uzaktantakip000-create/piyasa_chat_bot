Telegram Piyasa Sohbet SimÃ¼lasyonu

RolÃ¼n: KÄ±demli Platform MÃ¼hendisi + Uygulama MimarÄ± + DevOps.
Hedef: Telegramâ€™da â€œpiyasalarâ€ temalÄ±, baÅŸlangÄ±Ã§ta 10, ileride 60+ gerÃ§ek kullanÄ±cÄ± gibi yazan hesapla doÄŸal sohbet akÄ±ÅŸÄ± Ã¼reten sistemi tasarla, kur, koÅŸ. YÃ¶netim iÃ§in basit bir web arayÃ¼zÃ¼ saÄŸla. Sohbetlerde yapay zekÃ¢ izi asla gÃ¶rÃ¼nmesin.

0) BaÅŸarÄ± Ã–lÃ§Ã¼tleri (Acceptance Criteria)

 10 ayrÄ± Telegram botu ile tek bir grupta doÄŸal, dÃ¼zensiz aralÄ±klarla mesajlaÅŸma baÅŸlar; UIâ€™dan bot ekle/Ã§Ä±kar yapÄ±labilir; 60+ bota sorunsuz bÃ¼yÃ¼r.

 GerÃ§ekÃ§ilik: reply, @mention, arada kÄ±sa tepkiler (ğŸ‘ğŸ”¥), deÄŸiÅŸken uzunluk (1â€“5 cÃ¼mle Ã§oÄŸunluk, nadiren uzun), typing simÃ¼lasyonu; AI/bot olduÄŸuna dair tek iz yok.

 Panel (UI): Bot ekleme/silme/aktif-pasif, hÄ±z profili, mention/reply oranlarÄ±, global start/stop, canlÄ± log/metrikler.

 OrkestratÃ¶r: Poisson gecikme + Ã§alÄ±ÅŸma saatleri pencereleri; rate-limit; Redis/PG kalÄ±cÄ±lÄ±k; hatalara karÅŸÄ± geri deneme.

 DaÄŸÄ±tÄ±m: Docker Compose ile tek komutla ayaÄŸa kalkar; .env ile gizli anahtarlar; basit loglama ve metrik uÃ§larÄ±.

 DokÃ¼mantasyon: READMEâ€™de kurulum, .env ÅŸablonu, runbook, Ã¶lÃ§eklendirme ve sorun giderme yer alÄ±r.

1) Mimari Gereksinimler

BileÅŸenler:

OrkestratÃ¶r API (FastAPI, Python 3.10+): akÄ±ÅŸÄ± ve LLM Ã§aÄŸrÄ±larÄ±nÄ± yÃ¶netir.

Worker(lar): konuÅŸma dÃ¶ngÃ¼lerini Ã§alÄ±ÅŸtÄ±rÄ±r, Telegramâ€™a gÃ¶nderir.

Postgres: bot kayÄ±tlarÄ±, sohbet ayarlarÄ±, mesaj loglarÄ±.

Redis: kuyruk, token-bucket rate limit, pub/sub ile canlÄ± konfig yayÄ±mÄ±.

UI (Panel): Next.js/React (veya FastAPI templates).

LLM katmanÄ±: provider-agnostik generate(); tek modelle baÅŸla, deÄŸiÅŸtirilebilir olsun.

DaÄŸÄ±tÄ±m: Docker Compose (api, worker, db, redis, ui).

Åemalar:

bots(id, name, token, username, is_enabled, speed_profile jsonb, active_hours text[], persona_hint text)

chats(id, chat_id, title, is_enabled, topics text[])

settings(key, value jsonb) â†’ Ã¶rn. {"max_msgs_per_min":6,"typing":true,"prime_hours_boost":true}

messages(id, bot_id, chat_id, telegram_message_id, text, reply_to_message_id, created_at)

API uÃ§larÄ±:

POST /bots, PATCH /bots/{id}, GET /bots

POST /chats, GET /chats

POST /control/start, /control/stop, /control/scale?factor=0.8

GET /metrics (msg/min, hata oranÄ±, 429 sayÄ±sÄ±, aktif botlar)

GET /healthz

UI sayfalarÄ±: Dashboard (start/stop, hÄ±z), Bots (ekle/sil/aktif/hÄ±z profili), Chats (chat_id), Settings (prime hours, max msgs/min), Logs.

2) DavranÄ±ÅŸ Motoru (GerÃ§ekÃ§ilik KurallarÄ±)

Zamanlama: Exponential/Poisson gecikme. Prime hours (09:30â€“12:00, 14:00â€“18:00) daha kÄ±sa; diÄŸer saatlerde uzun.

SeÃ§im: Her â€œtickâ€te uygun botlardan rastgele 1 kiÅŸi konuÅŸur.

OlasÄ±lÄ±klar (baÅŸlangÄ±Ã§): reply %65, mention %35, yalnÄ±z kÄ±sa tepki %10â€“15, reaksiyon (sadece emoji) %12, yeni mesaj %35.

Uzunluk profili: kÄ±sa %55 (1â€“2 cÃ¼mle), orta %35 (3â€“5), uzun %10 (6+).

Typing: tahmini karakter sayÄ±sÄ±na gÃ¶re 2â€“8 sn; 2.5â€“4.5 wpm varyansÄ±.

Rate limit: bot baÅŸÄ±na saatlik 6â€“12 mesaj; grup toplamÄ± dkâ€™da 3â€“6; Telegram 429 iÃ§in backoff.

HafÄ±za: Son 4â€“6 mesajdan 300â€“400 karakterlik Ã¶zet; gerekirse yanÄ±t verilen mesajdan 1â€“2 cÃ¼mle alÄ±ntÄ± Ã¶zet (ham kopya yok).

Reaksiyonlar: mesaj yerine bazen ğŸ‘ğŸ”¥ğŸ’¡ bÄ±rak (API uygunsa), yoksa kÄ±sa â€œ+1â€ mesajÄ±.

Konular: BIST/FX/Kripto/Makro alt baÅŸlÄ±k etiketleri (Telegram Topics destekliyse kullan).

3) GÃ¼venlik, Gizlilik, Uyum

Yapay zekÃ¢ izi gizlensin: Ã‡Ä±kÄ±ÅŸta â€œAI, bot, model, otomasyonâ€ gibi ifadeleri yasakla.

Ä°Ã§erik gÃ¼venliÄŸi: kÃ¼fÃ¼r, ayrÄ±mcÄ±lÄ±k, siyaset, kiÅŸisel veri yok.

YatÄ±rÄ±m tavsiyesi verme: â€œGenel deÄŸerlendirmeâ€ Ã§erÃ§evesi; kesin emir/tavsiye yazma.

Gizli anahtarlar: .env (OPENAI_API_KEY, DB, REDIS, TELEGRAM tokens), repoya girmesin.

Kill-switch: UIâ€™dan anÄ±nda durdur.

Log Hijyen: KiÅŸisel veri loglama; tokenlarÄ± maskele.

4) Sohbet Ä°Ã§eriÄŸi iÃ§in Sabit Master Prompt (LLM System)

TÃ¼m botlar iÃ§in aynÄ± system promptâ€™u kullan; sohbet iÃ§inde AI olduÄŸuna dair tek iz bÄ±rakma.

AMAÃ‡:
Telegram grubunda piyasalar hakkÄ±nda konuÅŸan kullanÄ±cÄ±larÄ± simÃ¼le et. TÃ¼m sohbet yapay zekÃ¢ tarafÄ±ndan Ã¼retilse de
dÄ±ÅŸarÄ±dan bakan kesinlikle bunun farkÄ±na varmamalÄ±. Okuyan herkes, 10â€“60 gerÃ§ek kiÅŸinin yazdÄ±ÄŸÄ±nÄ± varsaymalÄ±.

DÄ°L VE TON:
- TÃ¼rkÃ§e, doÄŸal ve gÃ¼ndelik; saygÄ±lÄ±. GerektiÄŸinde hafif gayriresmÃ®.
- Mesaj uzunluÄŸu karÄ±ÅŸÄ±k: kÄ±sa (1â€“2 cÃ¼mle) Ã§oÄŸunluk, orta (3â€“5) sÄ±kÃ§a, uzun (6+) nadiren.
- Ã–lÃ§Ã¼lÃ¼ emoji (ğŸ‘ğŸ”¥ğŸ“‰ğŸ“ˆ). KÃ¼Ã§Ã¼k tereddÃ¼tler doÄŸal: â€œemin deÄŸilim amaâ€¦â€.

DAVRANIÅ:
- Bazen reply ve @mention kullan; bazen yeni yorum yaz.
- Arada sadece kÄ±sa tepki ver (â€œbence de ğŸ‘â€, â€œkatÄ±lÄ±yorumâ€).
- Soru sorarak akÄ±ÅŸÄ± ilerlet (â€œsizce dolar nereye gider?â€).
- AynÄ± fikri tekrarlama; her mesajda yeni veya destekleyici bir katkÄ± yap.
- Asla â€œAI/bot/otomasyonâ€ imasÄ± yapma.

KONU ODAÄI:
- BIST ve hisseler, USD/TRY, EUR/TRY, altÄ±n/emtia, kripto (BTC/ETH), faizler, makro veri ve gÃ¼ndem.

GÃœVENLÄ°K:
- YatÄ±rÄ±m tavsiyesi verme; kesin yÃ¶nlendirmeden kaÃ§Ä±n.
- KiÅŸisel veri, saldÄ±rgan/siyasi/ayrÄ±mcÄ± dil yok.

Ã‡IKTI:
- DÃ¼z TÃ¼rkÃ§e metin; doÄŸal, gÃ¼nlÃ¼k, insansÄ± akÄ±ÅŸ.


User (dinamik) ÅŸablon:

topic_name, history_excerpt (â‰¤400), reply_excerpt (â‰¤240, opsiyonel), market_trigger (opsiyonel), mode(reply|new), mention (opsiyonel).

Post-process: 1â€“5 cÃ¼mle hedef; 6+ ise kÄ±salt; 1 cÃ¼mle ise 2â€“3â€™e tamamla; tekrarlarÄ± temizle.

5) GÃ¶rev Listesi (AjanÄ±n icra etmesi gerekenler)

Repo iskeleti oluÅŸtur: app/ (api, worker, models, prompts), ui/, docker-compose.yml, README.md.

DB ÅŸemasÄ±nÄ± aletten uygula; alembic veya basit SQL baÅŸlangÄ±cÄ±.

FastAPI API uÃ§larÄ±nÄ± yaz; health/metrics dahil.

Worker dÃ¶ngÃ¼sÃ¼: gecikme modeli, seÃ§im olasÄ±lÄ±klarÄ±, typing simÃ¼lasyonu, rate limit, Redis pub/sub ile canlÄ± ayar.

LLM sarmalayÄ±cÄ±: generate(); tek saÄŸlayÄ±cÄ±yla baÅŸla (envâ€™den model/anahtar), konfigÃ¼rasyonla deÄŸiÅŸebilir.

Telegram yardÄ±mcÄ±larÄ±: sendMessage(reply_to), sendChatAction(typing), (varsa) reaction.

UI geliÅŸtirme: Bots/Chats/Control/Settings/Logs sayfalarÄ±; API Ã§aÄŸrÄ±larÄ±.

Docker Compose: tÃ¼m servisleri ayaÄŸa kaldÄ±r; .env.example oluÅŸtur.

Demo senaryosu: 10 bot ekle, bir gruba baÄŸla, 30 dakikalÄ±k akÄ±ÅŸÄ± Ã§alÄ±ÅŸtÄ±r; ekran gÃ¶rÃ¼ntÃ¼sÃ¼/log ekle.

README/runbook: kurulum, ortam deÄŸiÅŸkenleri, Ã¶lÃ§ekleme (--scale worker=3), sorun giderme, Telegram rate-limit notlarÄ±.

6) BaÅŸlangÄ±Ã§ Parametreleri (varsayÄ±lan)

Prime hours: 09:30â€“12:00, 14:00â€“18:00 (gecikme medyanÄ± kÄ±salt).

Reply %65, Mention %35, KÄ±sa tepki %12â€“15, Yeni mesaj %35.

Uzunluk profili: kÄ±sa %55, orta %35, uzun %10.

Bot baÅŸÄ±na saatlik 6â€“12 mesaj; grup dkâ€™da 3â€“6.

Typing 2â€“8 sn; wpm 2.5â€“4.5 varyansÄ±.

UIâ€™dan tÃ¼m oranlar ve hÄ±z profili deÄŸiÅŸtirilebilir olmalÄ±.

7) Teslimatlar (Ã§Ä±ktÄ±lar)

Ã‡alÄ±ÅŸÄ±r Docker Compose paketi.

UI eriÅŸimi ve yÃ¶netim kullanÄ±cÄ±larÄ± (ÅŸimdilik basit auth).

.env.example (OPENAI_API_KEY, DATABASE_URL, REDIS_URL, TELEGRAM_CHAT_ID).

README + 5 dakikalÄ±k â€œQuickstartâ€ + sorun giderme bÃ¶lÃ¼mÃ¼.

KÄ±sa video/gif veya ekran gÃ¶rÃ¼ntÃ¼leri (opsiyonel ama tercih).

8) Test Kontrolleri

30 dk stres testi: 10 bot â†’ msg/min hedefleri; 429 oranÄ± dÃ¼ÅŸÃ¼k.

UIâ€™dan bir botu kapat/aÃ§: anÄ±nda akÄ±ÅŸta etkisini gÃ¶r.

Yeni bot ekle (sadece token gir): workerâ€™lar hot-reload ile 1 dk iÃ§inde konuÅŸmaya katÄ±yor.

AI izi kontrolÃ¼: 100 mesaj Ã¶rneÄŸini tara; â€œAI/botâ€ iÃ§eren yok.

YatÄ±rÄ±m tavsiyesi anahtar kelimeleri: yok ya da â€œgenel yorumâ€ Ã§erÃ§evesi korunmuÅŸ.

9) SÄ±nÄ±rlamalar ve Notlar

Yasal/etik sÄ±nÄ±rlar korunacak; KVKK ve platform kurallarÄ±na uygunluk.

GerÃ§ek zamanlÄ± fiyat/veri ÅŸart deÄŸil; eklersen tetikleyici mesajlarÄ± 2â€“3 kiÅŸi yorumlasÄ±n, tÃ¼m grup deÄŸil.

Token/maliyet iÃ§in kÄ±sa yanÄ±t hedefi; sorun olursa UIâ€™dan hÄ±z dÃ¼ÅŸÃ¼rÃ¼lebilir.

Åimdi bu brifi uygula.
Kodu, konfigÃ¼rasyonlarÄ± ve dokÃ¼mantasyonu oluÅŸtur; varsayÄ±lan 10 botla Ã§alÄ±ÅŸÄ±r hale getir; Ã¶lÃ§eklemeyi ve UI kontrolÃ¼nÃ¼ doÄŸrula; ardÄ±ndan READMEâ€™ye â€œYÃ¶netici HÄ±zlÄ± BaÅŸlangÄ±Ã§â€ bÃ¶lÃ¼mÃ¼ ekle
